{% extends "@QSCOR/Workspace/index.html.twig" %}
{% block menuapplication %}
    <ul class="vertical menu menucanvas menuapplicationindex" data-accordion-menu>
        <li>
            <a href="#" style="color: #FBFCF7">{{ projectname }}</a>
            <ul class="menu vertical is-active" >
                <li{% if app.session.get('routename') == 'networking' %}
                    class="active"
                        {% endif %}>
                    <a href="{{ path('networking',{'projectname' : projectname}) }}" style="font-size: 15px; color: #FBFCF7"><i class="step fi-map" style="font-size: 24px"></i>Networking</a>
                    {% if app.session.get('routename') == 'networking' %}
                        <ul class="menu vertical is-active" >
                            {#<li><a href="#" style="font-size: 15px">Company</a></li>#}
                            {#<li><a href="#" style="font-size: 15px">Type Facility</a></li>#}
                            {#<li><a href="#" style="font-size: 15px">Site</a>#}
                            {#<ul class="menu vertical nested">#}
                            {#<li><a href="#" style="font-size: 15px">Setting Sites</a></li>#}
                            {#<li><a href="#" style="font-size: 15px">Contact Person</a></li>#}
                            {#</ul>#}
                            {#</li>#}

                            {#<li><a href="{{ path('networking',{'projectname' : projectname} ) }}" style="font-size: 15px; color: #FBFCF7">Networking</a>#}
                            {#</li>#}
                            <li><a href="{{ path('company_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Companies</a></li>
                            <li><a href="{{ path('type_facility_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Facilities</a></li>
                            <li class="
                                                {% if app.session.get('routename') == 'modelling' or
                            app.request.attributes.get('_route') == 'site_new' or
                            app.request.attributes.get('_route') == 'site_index' or
                            app.request.attributes.get('_route') == 'site_edit'
                            %}appactive{% endif %}">
                                <a href="{{ path('site_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Sites</a></li>
                            <li><a href="{{ path('flow_site_index', {'projectname': app.request.attributes.get('projectname')}) }}" style="font-size: 13px;color: #FBFCF7">Flow Sites</a></li>
                            <li>

                                <div class="btnnetworking">
                                    <a href="{{ path('networkingmaps', {'projectname': app.request.attributes.get('projectname')}) }}" >
                                        Show Network
                                    </a>
                                </div>
                            </li>

                        </ul>
                    {% endif %}

                </li>
                <li{% if app.session.get('routename') == 'modelling' %}
                    class="active"
                        {% endif %}>
                    <a href="{{ path('modelling',{'projectname' : projectname}) }}" style="font-size: 15px; color: #FBFCF7"><i class="step fi-shuffle" style="font-size: 24px"></i>Modelling</a>
                    {% if app.session.get('routename') == 'modelling' %}
                        <ul class="menu vertical is-active" >
                            <li><a href="{{ path('company_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Companies</a></li>
                            <li><a href="{{ path('type_facility_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Facilities</a></li>
                            <li class="
                                                {% if app.session.get('routename') == 'modelling' or
                            app.request.attributes.get('_route') == 'site_new' or
                            app.request.attributes.get('_route') == 'site_index' or
                            app.request.attributes.get('_route') == 'site_edit'
                            %}appactive{% endif %}">
                                <a href="{{ path('site_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Sites</a></li>
                            <li>

                                <div class="btnnetworking">
                                    <a href="{{ path('modellingprojectschema', {'projectname': app.request.attributes.get('projectname')}) }}" >
                                        Show Modelling for this Project
                                    </a>
                                </div>
                            </li>
                        </ul>
                    {% endif %}

                </li>

                <li{% if app.session.get('routename') == 'performance' %}
                    class="active"
                        {% endif %}>
                    <a href="{{ path('performance',{'projectname' : projectname}) }}" style="font-size: 15px;color: #FBFCF7">
                        <i class="step fi-graph-bar" style="font-size: 24px"></i>Performance
                    </a>
                    {% if app.session.get('routename') == 'performance' %}
                        <ul class="menu vertical is-active" >
                            <li class="{% if app.request.attributes.get('_route') == 'performancemode'
                            %}appactive{% endif %}">
                                <a href="{{ path('performancemode',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Performance Mode</a>
                            </li>
                            <li><a href="{{ path('company_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Companies</a></li>
                            <li><a href="{{ path('type_facility_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Facilities</a></li>
                            <li class="
                                                {% if app.session.get('routename') == 'performance' or
                            app.request.attributes.get('_route') == 'site_new' or
                            app.request.attributes.get('_route') == 'site_index' or
                            app.request.attributes.get('_route') == 'site_edit'
                            %}appactive{% endif %}">
                                <a href="{{ path('site_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Sites</a></li>
                        </ul>
                    {% endif %}

                </li>

                <li {% if   app.request.attributes.get('_route') == 'project_edit' %}
                    class="active"
                {% endif %}
                ><a href="{{ path('project_edit',{'projectname' : projectname,'id': app.session.get('projectid')| urlencrypt}) }}" style="font-size: 15px;color: #FBFCF7"><i class="step fi-widget" style="font-size: 24px"></i>Settings Projects</a>
                </li>
            </ul>
        </li>


    </ul>
{% endblock %}
{% block workspace %}
    <nav aria-label="You are here:" role="navigation">
        <ul class="breadcrumbs">
            <li><a href="{{ path('site_index',{'projectname': projectname}) }}">sites</a></li>
    {% for performancetype in performancetypes %}
        {% if performancetype.libellePerformance == 'reliability'  %}
            <li>{{ performancetype.libellePerformance }}</li>
        {% else %}
            <li><a href="{{ path(performancetype.libellePerformance, {'projectname':projectname, 'idsite':site.id|urlencrypt}) }}">{{ performancetype.libellePerformance }}</a></li>
        {% endif %}
    {% endfor %}

        </ul>
    </nav>





    {% if performance | length !=0 %}
                <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
                <script src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.2/mootools-yui-compressed.js" type="text/javascript"></script>
                <script src="//code.highcharts.com/3.0.10/adapters/mootools-adapter.js" type="text/javascript"></script>
                <script src="//code.highcharts.com/4.1.8/highcharts.js"></script>
                <script src="//code.highcharts.com/4.1.8/modules/exporting.js"></script>
                <script type="text/javascript">
                    {#{{ chart(chart, 'mootools') }}#}
                    {{ chart(chart) }}
                </script>

                <div id="linechart" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
               <div class="row large-6 large-offset-4" style="margin-top: 1rem">
                    <a href="{{ path('performancedelete', {'projectname': projectname, 'idsite': site.id |urlencrypt, 'idperformance' : performance.id}) }}" class="button">
                        Delete this performance
                    </a>
               </div>
    {% else %}
        {% for performancetype in performancetypes %}

            {%if performancetype.libellePerformance == 'reliability'  %}
                <h4>Reliability Performance</h4>
                <p> Calcule Perfect order Fulfilment</p>
             <div class="formModal" style="margin-top: 0">
                <form method="post" action="{{ path('reliabilitycalcule', {'projectname': projectname, 'idsite': site.id, 'idperformance':performancetype.id}) }}">

                    <div class="Modalrow">

                        <div class="Modallabel">
                            <label> Total Perfect Orders (%)</label>
                        </div>
                        <div class="Modalwidget">
                            <input type="number" name="perfectorder" min=0  id="fulfilmentorder" required>
                        </div>
                    </div>

                    <ul class="accordion" data-accordion data-allow-all-closed="true" style="margin-top: 1rem">
                        <li class="accordion-item" data-accordion-item >
                            <a href="#" class="accordion-title">Show me how to calculate this value</a>
                            <div class="accordion-content" data-tab-content>
                                <div class="Modalrow">

                                    <div class="Modallabel">
                                        <label id="lab1"> Orders Deliverd in Full (%)</label>
                                    </div>
                                    <div class="Modalwidget">

                                        <input type="number" id="val1" min="0" max="100">
                                    </div>
                                </div>

                                <div class="Modalrow">

                                    <div class="Modallabel">
                                        <label id="lab2"> Perfect Condition (%)</label>
                                    </div>
                                    <div class="Modalwidget">
                                        <input type="number" id="val2" min="0" =max="100">
                                    </div>
                                </div>

                                <div class="Modalrow">

                                    <div class="Modallabel">
                                        <label id ="lab3"> Orders Received Defect Free (%)</label>
                                    </div>
                                    <div class="Modalwidget">
                                        <input type="number" id="val3" min="0" max="100">
                                    </div>
                                </div>

                                <div class="Modalrow">

                                    <div class="Modallabel">
                                        <label id="lab4"> Order Received Damage Free (%)</label>
                                    </div>
                                    <div class="Modalwidget">
                                        <input type="number" id="val4" min="0" max="100">
                                    </div>
                                </div>
                                <a style="margin-top: 1rem" class="button" onclick="calculeFulfilment();">calculate this value</a>
                            </div>
                        </li>
                    </ul>

                    <div class="Modalrow">

                        <div class="Modallabel">
                            <label id="lab4"> Total Number of Orders</label>
                        </div>
                        <div class="Modalwidget">
                            <input type="number" name="numberorder" min="0" required>
                        </div>
                    </div>
                    <input style="margin-top: 1rem" type="submit" value="create" class="button success"  >
                </form>
            {% endif %}
        {% endfor %}
    {% endif %}

    <script type="text/javascript">
        function calculeFulfilment(){
//            alert('ok');
            var sum = 1;
            var val = 0;
            for(i = 1 ; i <=4; i++){
                val = document.getElementById('val'+i).value;
                if(val == null)
                        val = 1;
				else {
					if(val > 100) {
						var labelname = document.getElementById('lab'+i).innerHTML;
						var labellength = labelname.length-4;
						var message = "\""+ labelname.substr(1,labellength) + "\"" + " cannot not exceed 100%\nThis value has been set to 100";
						val = document.getElementById('val'+i).value=100;
						alert(message);
					}
				
                sum *= parseInt(val)/100; 
				}
            }
           document.getElementById('fulfilmentorder').value = sum*100;


        }
    </script>
{% endblock %}