{% extends "@QSCOR/Workspace/index.html.twig" %}
{% block menuapplication %}
    <ul class="vertical menu menucanvas menuapplicationindex" data-accordion-menu>
        <li>
            <a href="#" style="color: #FBFCF7">{{ projectname }}</a>
            <ul class="menu vertical is-active" >
                <li{% if app.session.get('routename') == 'networking' %}
                    class="active"
                        {% endif %}>
                    <a href="{{ path('networking',{'projectname' : projectname}) }}" style="font-size: 15px; color: #FBFCF7"><i class="step fi-map" style="font-size: 24px"></i>Networking</a>
                    {% if app.session.get('routename') == 'networking' %}
                        <ul class="menu vertical is-active" >
                            {#<li><a href="#" style="font-size: 15px">Company</a></li>#}
                            {#<li><a href="#" style="font-size: 15px">Type Facility</a></li>#}
                            {#<li><a href="#" style="font-size: 15px">Site</a>#}
                            {#<ul class="menu vertical nested">#}
                            {#<li><a href="#" style="font-size: 15px">Setting Sites</a></li>#}
                            {#<li><a href="#" style="font-size: 15px">Contact Person</a></li>#}
                            {#</ul>#}
                            {#</li>#}

                            {#<li><a href="{{ path('networking',{'projectname' : projectname} ) }}" style="font-size: 15px; color: #FBFCF7">Networking</a>#}
                            {#</li>#}
                            <li><a href="{{ path('company_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Companies</a></li>
                            <li><a href="{{ path('type_facility_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Facilities</a></li>
                            <li class="
                                                {% if app.session.get('routename') == 'modelling' or
                            app.request.attributes.get('_route') == 'site_new' or
                            app.request.attributes.get('_route') == 'site_index' or
                            app.request.attributes.get('_route') == 'site_edit'
                            %}appactive{% endif %}">
                                <a href="{{ path('site_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Sites</a></li>
                            <li><a href="{{ path('flow_site_index', {'projectname': app.request.attributes.get('projectname')}) }}" style="font-size: 13px;color: #FBFCF7">Flow Sites</a></li>
                            <li>

                                <div class="btnnetworking">
                                    <a href="{{ path('networkingmaps', {'projectname': app.request.attributes.get('projectname')}) }}" >
                                        Show Network
                                    </a>
                                </div>
                            </li>

                        </ul>
                    {% endif %}

                </li>
                <li{% if app.session.get('routename') == 'modelling' %}
                    class="active"
                        {% endif %}>
                    <a href="{{ path('modelling',{'projectname' : projectname}) }}" style="font-size: 15px; color: #FBFCF7"><i class="step fi-shuffle" style="font-size: 24px"></i>Modelling</a>
                    {% if app.session.get('routename') == 'modelling' %}
                        <ul class="menu vertical is-active" >
                            <li><a href="{{ path('company_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Companies</a></li>
                            <li><a href="{{ path('type_facility_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Facilities</a></li>
                            <li class="
                                                {% if app.session.get('routename') == 'modelling' or
                            app.request.attributes.get('_route') == 'site_new' or
                            app.request.attributes.get('_route') == 'site_index' or
                            app.request.attributes.get('_route') == 'site_edit'
                            %}appactive{% endif %}">
                                <a href="{{ path('site_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Sites</a></li>
                            <li>

                                <div class="btnnetworking">
                                    <a href="{{ path('modellingprojectschema', {'projectname': app.request.attributes.get('projectname')}) }}" >
                                        Show Modelling for this Project
                                    </a>
                                </div>
                            </li>
                        </ul>
                    {% endif %}

                </li>

                <li{% if app.session.get('routename') == 'performance' %}
                    class="active"
                        {% endif %}>
                    <a href="{{ path('performance',{'projectname' : projectname}) }}" style="font-size: 15px;color: #FBFCF7">
                        <i class="step fi-graph-bar" style="font-size: 24px"></i>Performance
                    </a>
                    {% if app.session.get('routename') == 'performance' %}
                        <ul class="menu vertical is-active" >
                            <li class="{% if app.request.attributes.get('_route') == 'performancemode'
                            %}appactive{% endif %}">
                                <a href="{{ path('performancemode',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Performance Mode</a>
                            </li>
                            <li><a href="{{ path('company_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Companies</a></li>
                            <li><a href="{{ path('type_facility_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Facilities</a></li>
                            <li class="
                                                {% if app.session.get('routename') == 'performance' or
                            app.request.attributes.get('_route') == 'site_new' or
                            app.request.attributes.get('_route') == 'site_index' or
                            app.request.attributes.get('_route') == 'site_edit'
                            %}appactive{% endif %}">
                                <a href="{{ path('site_index',{'projectname':projectname}) }}" style="font-size: 13px; color: #FBFCF7; ">Sites</a></li>
                        </ul>
                    {% endif %}

                </li>

                <li {% if   app.request.attributes.get('_route') == 'project_edit' %}
                    class="active"
                {% endif %}
                ><a href="{{ path('project_edit',{'projectname' : projectname,'id': app.session.get('projectid')| urlencrypt}) }}" style="font-size: 15px;color: #FBFCF7"><i class="step fi-widget" style="font-size: 24px"></i>Settings Projects</a>
                </li>
            </ul>
        </li>


    </ul>
{% endblock %}
{% block workspace %}
    <nav aria-label="You are here:" role="navigation">
        <ul class="breadcrumbs">
            <li><a href="{{ path('site_index',{'projectname': projectname}) }}">sites</a></li>
            {% for performancetype in performancetypes %}
                {% if performancetype.libellePerformance == 'assetmanagement'  %}
                    <li>{{ performancetype.libellePerformance }}</li>
                {% else %}
                    {#{% if  performancetype.libellePerformance == 'reliability'%}#}
                        {#<li><a href="{{ path('performancecalcul', {'projectname':projectname, 'idsite':site.id|urlencrypt}) }}">{{ performancetype.libellePerformance }}</a></li>#}
                    {#{% else %}#}
                        <li><a href="{{ path(performancetype.libellePerformance, {'projectname':projectname, 'idsite':site.id|urlencrypt}) }}">{{ performancetype.libellePerformance }}</a></li>
                    {#{% endif %}#}
                {% endif %}
            {% endfor %}

        </ul>
    </nav>
    {#{{ dump(performances) }}#}

    {% if performance | length !=0 %}
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.2/mootools-yui-compressed.js" type="text/javascript"></script>
    <script src="//code.highcharts.com/3.0.10/adapters/mootools-adapter.js" type="text/javascript"></script>
    <script src="//code.highcharts.com/4.1.8/highcharts.js"></script>
    <script src="//code.highcharts.com/4.1.8/modules/exporting.js"></script>
    <script type="text/javascript">
        {#{{ chart(chart, 'mootools') }}#}
        {{ chart(chart1) }}
        {{ chart(chart2) }}

    </script>

    <div id="linechart" style="margin-right: 1rem; margin-bottom: 5rem"></div>
    <div id="linechart2" style="margin-right: 1rem"></div>
    <div class="row large-6 large-offset-4" style="margin-top: 1rem">
        <a href="{{ path('performancedelete', {'projectname': projectname, 'idsite': site.id |urlencrypt, 'idperformance' : performance.id}) }}" class="button">
            Delete this performance
        </a>
    </div>
    {% else %}
    {% for performancetype in performancetypes %}
    {%if performancetype.libellePerformance == 'assetmanagement'  %}
    <h4>Asset Management Performance</h4>

    <div class="formModal" style="margin-top: 0">
        <form method="post" action="{{ path('assetmanagementcalcule', {'projectname': projectname, 'idsite': site.id, 'idperformance':performancetype.id}) }}">

            <div class="Modalrow">

                <div class="Modallabel">
                    <label> Cash-to-Cash Cycle Time</label>
                </div>
                <div class="Modalwidget">
                    <input type="number" name="cct" min=0  id="cct" required>
                </div>
            </div>

            <ul class="accordion" data-accordion data-allow-all-closed="true" style="margin-top: 1rem">
                <li class="accordion-item" data-accordion-item >
                    <a href="#" class="accordion-title">Show Me How Calcul This Value</a>
                    <div class="accordion-content" data-tab-content>
                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Inventory Days of Supply </label>
                            </div>
                            <div class="Modalwidget">

                                <input type="number" id="val1"  min="0" placeholder="insert value in days">
                            </div>
                        </div>

                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Days Sales Outstanding  </label>
                            </div>
                            <div class="Modalwidget">
                                <input type="number" id="val2" min="0" placeholder="insert value in days">
                            </div>
                        </div>

                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Days Payable Outstanding </label>
                            </div>
                            <div class="Modalwidget">
                                <input type="number" id="val3" min="0" placeholder="insert value in days">
                            </div>
                        </div>
                        <a style="margin-top: 1rem" class="button" onclick="calculecashcycletime()"> calcule this value</a>
                    </div>
                </li>
            </ul>


            <div class="Modalrow">

                <div class="Modallabel">
                    <label> Return on Supply Chain Fixed Assets</label>
                </div>
                <div class="Modalwidget">
                    <input type="number" name="rscfa" min=0  id="rscfa" required>
                </div>
            </div>

            <ul class="accordion" data-accordion data-allow-all-closed="true" style="margin-top: 1rem">
                <li class="accordion-item" data-accordion-item >
                    <a href="#" class="accordion-title">Show Me How Calcul This Value</a>
                    <div class="accordion-content" data-tab-content>
                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Supply Chain Revenue </label>
                            </div>
                            <div class="Modalwidget">

                                <input type="number" id="val4"  min="0" placeholder="insert value in euro">
                            </div>
                        </div>

                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Total Cost to Server </label>
                            </div>
                            <div class="Modalwidget">
                                <input type="number" id="val5" min="0" placeholder="insert value in euro">
                            </div>
                        </div>

                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Supply Chain Fixed Assets </label>
                            </div>
                            <div class="Modalwidget">
                                <input type="number" id="val6" min="0" placeholder="insert value in euro">
                            </div>
                        </div>
                        <a style="margin-top: 1rem" class="button" onclick="calculeReturnSupply()"> calcule this value</a>
                    </div>
                </li>
            </ul>


            <div class="Modalrow">

                <div class="Modallabel">
                    <label> Return on Working Capital</label>
                </div>
                <div class="Modalwidget">
                    <input type="number" name="rwc" min=0  id="rwc" required>
                </div>
            </div>

            <ul class="accordion" data-accordion data-allow-all-closed="true" style="margin-top: 1rem">
                <li class="accordion-item" data-accordion-item >
                    <a href="#" class="accordion-title">Show Me How Calcul This Value</a>
                    <div class="accordion-content" data-tab-content>
                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Supply Chain Revenue </label>
                            </div>
                            <div class="Modalwidget">

                                <input type="number" id="val7"  min="0" placeholder="insert value in euro">
                            </div>
                        </div>

                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Total Cost to Server </label>
                            </div>
                            <div class="Modalwidget">
                                <input type="number" id="val8" min="0" placeholder="insert value in euro">
                            </div>
                        </div>

                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Inventory </label>
                            </div>
                            <div class="Modalwidget">
                                <input type="number" id="val9" min="0" placeholder="insert value in euro">
                            </div>
                        </div>
                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Accounts Receivable </label>
                            </div>
                            <div class="Modalwidget">
                                <input type="number" id="val10" min="0" placeholder="insert value in euro">
                            </div>
                        </div>

                        <div class="Modalrow">

                            <div class="Modallabel">
                                <label> Accounts Payable </label>
                            </div>
                            <div class="Modalwidget">
                                <input type="number" id="val11" min="0" placeholder="insert value in euro">
                            </div>
                        </div>

                        <a style="margin-top: 1rem" class="button" onclick="calculeReturnWorking()"> calcule this value</a>
                    </div>
                </li>
            </ul>

            <input style="margin-top: 1rem" type="submit" value="create" class="button success"  >
        </form>
        {% endif %}
        {% endfor %}
        {% endif %}


        <script type="text/javascript">
            function calculecashcycletime(){
//            alert('ok');

                var val1 = document.getElementById('val1').value;
                var val2 = document.getElementById('val2').value;
                var val3 = document.getElementById('val3').value;

                document.getElementById('cct').value = parseInt(val1) + parseInt(val2) - parseInt(val3);


            }

            function calculeReturnSupply(){
                var val1 = document.getElementById('val4').value;
                var val2 = document.getElementById('val5').value;
                var val3 = document.getElementById('val6').value;

                if(val3 == null){
                    val3 = 1;
                }

                document.getElementById('rscfa').value = parseInt(val1) - parseInt(val2) / parseInt(val3);
            }

            function calculeReturnWorking(){

                var val1 = document.getElementById('val7').value;
                var val2 = document.getElementById('val8').value;
                var val3 = document.getElementById('val9').value;
                var val4 = document.getElementById('val10').value;
                var val5 = document.getElementById('val11').value;

               var iaa = parseFloat(val3) + parseFloat(val4) - parseFloat(val5);

                if(iaa == null){
                    iaa = 1;
                }

                document.getElementById('rwc').value = parseInt(val1) - parseInt(val2) / iaa;
            }
        </script>
{% endblock %}